#imported the cleaned and preprocessed data into bit.io and analyzed the data.

1.What is the most common room type in NYC Airbnb listings?
SELECT room_type Category,COUNT(*) Count 
FROM room_types 
GROUP by room_type 
ORDER by 2

2.What is the average price of a listing by room type?
SELECT room_type Category,AVG(price) Price 
FROM room_types r 
JOIN prices p
ON  r.listing_id=p.listing_id
GROUP by room_type 
ORDER by 2

3.Which borough has the highest average price per month?
SELECT borough borough, ROUND(AVG(price*365/12), 2) avg_price 
FROM prices 
GROUP By 1
ORDER by 2 DESC LIMIT 1

4.How many listings of each room type are in each borough?
SELECT borough borough,room_type room_type, count(*) Listing 
FROM prices p
JOIN room_types r
ON p.listing_id=r.listing_id 
GROUP BY 1,2

5.How many listings in each room type category have a price of over $500 per night?
SELECT room_type category,count(*) listing 
FROM room_types r
JOIN prices p
ON r.listing_id=p.listing_id
where price > 500
GROUP BY 1

6.What is the distribution of listing prices by neighborhood?
SELECT borough,MIN(price) min_price,
Max(price) max_price,ROUND(AVG(price),2)
 FROM prices 
GROUP BY 1

7.What is the estimated amount of revenue generated by hosts in each borough?
SELECT borough borough, SUM(price*booked_days_365) 
FROM prices p
JOIN reviews r
ON p.listing_id=r.listing_id
 	GROUP by 1


8.What is the average price per month for listings in each neighborhood?
	SELECT neighbourhood neighbourhood,room_type room_type,
AVG(price_per_month)
FROM prices p JOIN room_types r
ON p.listing_id=r.listing_id
GROUP BY 1,2
ORDER BY 3 desc

9.How many listings have no reviews?
SELECT count(*) 
FROM reviews 
WHERE number_of_reviews=0

10.How do the estimated book days correlate with the price of an Airbnb listing in New York City?
SELECT
    	CORR(price, booked_days_365) AS correlation
FROM prices
JOIN reviews
ON prices.listing_id = reviews.listing_id

